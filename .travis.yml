# This is a template for other packages (i.e., beside pfs_pipe2d) to use
# as a ".travis.yml" file to enable Travis-CI. This enables CI on the
# entire pipeline when changing only a single product in the stack.

language: minimal
services:
  - docker
os:
  - linux
jobs:
  fast_finish: true
notifications:
  email: false
  slack:
    secure: BWL1De9DBWZ+Um0NR880tWpGw/3b99wakJ9P5Lu7b6N0JJNYe6f3nmDGukFh7uVeABlJUKz1EgR9hZKNR/PoKsCB+14x6f6EMGcSMjRpXTNv8mMkSN3msiFBGnyA7udwCv/CvMcJBV2K80MRfQHBLAKV/q5S7/oQIlCXNOH0BU0WF1PnCyqTQSMoK0Mk8CADrN5o8O8xSzg6B+Mwx50d6B9aJtIngmC6rxEiOvbyfUA0oAkdTPDIqWyomtAj4USAXroIIsGDuL9+namw5ow3Z+xurQ5fjpVwAh7mjHqTRa5l826VnkMdrpq6+FkDjBGidTALJokmnAw+t+BJwOSwX1u8ntwUctDX2MRnyjYMZCkgibWcdjyB26ncMFBXAcO9whvKM0rNqov2oohSX0bkSGVXlAx0sphnDCNoNiktaJpZcei5MSaAHulU+R3F0AGk6cGkiBs2TSfCCJZDZclEv2jqBsZed0M5jluqr6jwigh39IZKiLAjFm1tp9fg5masjkaLVKWpWyVLjUuU7gataKnR2uKKtHbr7iWaNOlFDL3mcGLGk51WUD54VP81KgURvbwIZp1+f6X947jdLvv9eLykV6kr3SBlcvmxaLbU46X6nM4QoObYNdgiv2MA+PcHpKwUFOBhBzZzlvX/vo1XYRQRiVflMNN1zvSr8iURLr8=
branches:
  only:
    - master

# The actual installation is done under the 'script' so as to consolidate the
# necessary front-end machinery (intercept log, decide which branch to use).
install:
  - cd $HOME
  - git clone -b ${TRAVIS_PULL_REQUEST_BRANCH:-$TRAVIS_BRANCH} --single-branch http://github.com/Subaru-PFS/pfs_pipe2d || git clone -b master --single-branch http://github.com/Subaru-PFS/pfs_pipe2d
script: /bin/bash pfs_pipe2d/bin/pfs_travis.sh
